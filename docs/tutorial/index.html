<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Installation EULER_PRODUCT" href="install_dev.html" /><link rel="prev" title="Welcome to EULER PRODUCT documentation!" href="../index.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2024.01.29 -->
        <title>Tutorial Euler Product - sage-euler-product 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="https://doc.sagemath.org/html/en/reference/_static/custom-furo.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">sage-euler-product 0.0.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/nntdm-small.jpg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/nntdm-small.jpg" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">sage-euler-product 0.0.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Tutorial Euler Product</a></li>
<li class="toctree-l1"><a class="reference internal" href="install_dev.html">Installation EULER_PRODUCT</a></li>
<li class="toctree-l1"><a class="reference internal" href="LoeschianConstant-NS-04-MCOMP.html">Fast multi-precision computation of some Euler products</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/api.html">API Documentation</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="tutorial-euler-product">
<span id="index"></span><h1>Tutorial Euler Product<a class="headerlink" href="#tutorial-euler-product" title="Link to this heading">#</a></h1>
<section id="introduction-and-principles">
<h2>Introduction and principles<a class="headerlink" href="#introduction-and-principles" title="Link to this heading">#</a></h2>
<p>The main object of this software is to compute in a very fast manner Euler products with rational local factors over primes in some collections of arithmetic progressions modulo some fixed modulus <span class="math notranslate nohighlight">\(q\)</span>. The computations are done with interval arithmetic, the results are certified and given in the form <code class="code docutils literal notranslate"><span class="pre">(lower_bound,</span> <span class="pre">upper_bound)</span></code>.
An Euler product is a product over all the (positive integer) primes, possibly in some subsequence.
Here are two examples  <span class="math notranslate nohighlight">\(E_1=\prod_{p\equiv 3,5[7]}(1-1/p^2)\)</span>, where the product is taken over every prime <span class="math notranslate nohighlight">\(p\)</span> congruent to 3 or 5 modulo 7, and <span class="math notranslate nohighlight">\(E_2 = \prod_{p\equiv 1[8]}\bigl(1-\frac{4}{p}\bigr)\bigl(\frac{p+1}{p-1}\bigr)^2\)</span>, the so-called Shanks’s constant, where the product is taken over every prime congruent to 1 modulo 8.</p>
<p>During the computations, Euler products over rational functions such as <span class="math notranslate nohighlight">\(E_2\)</span> are inferred from simpler Euler products of the shape</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\prod_{p\in\mathcal{A}\mod q}(1-1/p^s),\]</div>
</div>
<p>by following the 2021 paper of Ettahri, Surel and Ramaré,  where</p>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathcal{A}\)</span> is some subset of <span class="math notranslate nohighlight">\(G=(\mathbb{Z}/q\mathbb{Z})^\times\)</span>. The subset <span class="math notranslate nohighlight">\(\mathcal{A}\)</span> has to be the union of “lattice invariant classes”, as described below.</p></li>
<li><p><span class="math notranslate nohighlight">\(q\)</span> is a positive integer, the so-called “modulus”. We have <span class="math notranslate nohighlight">\(q=7\)</span> for <span class="math notranslate nohighlight">\(E_1\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(s\)</span> is a real parameter that is strictly positif and *in this example* strictly larger than 1. A typical choice is <span class="math notranslate nohighlight">\(s=2\)</span>.</p></li>
</ul>
</div></blockquote>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>The mathematical proof of this software is taken from the paper ** Fast multi-precision computation of some Euler products ** by Salma Ettahri, Olivier Ramaré and Léon Surel, published in 2021, in volume 90 of *Mathematics of Computations*, pages 2247 to 2265.</p>
</div>
<p>In case <span class="math notranslate nohighlight">\(q = 1\)</span>, the notion of lattice invariant classes is trivial. Let us start by describing this case.</p>
</section>
<section id="euler-product-over-every-primes">
<h2>Euler Product over every primes<a class="headerlink" href="#euler-product-over-every-primes" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">euler_product.lattice_invariant_euler_products</span> <span class="kn">import</span> <span class="n">get_euler_products</span>
<span class="n">get_euler_products</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.1</span> <span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">with_Latex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">digits_offset</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>This computes the Euler product <span class="math notranslate nohighlight">\(\prod_{p\ge2}\frac{1-1/p^{2s}}{1+1/p^{3s}}\)</span> where <span class="math notranslate nohighlight">\(s = 2.1\)</span> with potentially 103 correct digits and by computing directly the Euler product for all the primes less than <span class="math notranslate nohighlight">\(P=20\)</span>. This value of <span class="math notranslate nohighlight">\(P\)</span> is 300 by default. The level of comments <code class="code docutils literal notranslate"><span class="pre">verbose</span></code> can be set to 0, 1 or 2. The additional parameter <code class="code docutils literal notranslate"><span class="pre">with_Latex</span></code> is either equal to 1 or not equal to 1, with an obvious meaning. If the output does not have enough correct digits, the user is asked to increase the value 103 to 110 for instance. We decided not to automate this behaviour.</p>
<p>The parameter <code class="code docutils literal notranslate"><span class="pre">digits_offset</span></code> is not used as of now.</p>
<p>On the effect of the choice of <span class="math notranslate nohighlight">\(s\)</span>, notice that the two calls</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">get_euler_products</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">103</span><span class="p">)</span>
<span class="n">get_euler_products</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">103</span><span class="p">)</span>
</pre></div>
</div>
<p>give the same answer, which is readily seen to be an approximation of <span class="math notranslate nohighlight">\(1/\zeta(4)\)</span>, where <span class="math notranslate nohighlight">\(\zeta\)</span> is the Riemann-zeta function. Recall that we have <span class="math notranslate nohighlight">\(\zeta(4)=\pi^4/90\)</span>, a fact that we may use to check our code.</p>
</section>
<section id="lattice-invariant-classes-modulo-q">
<h2>Lattice Invariant Classes modulo <span class="math notranslate nohighlight">\(q\)</span><a class="headerlink" href="#lattice-invariant-classes-modulo-q" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Definition of Lattice Invariant Classes</p></li>
</ul>
<p>We subdivide the multiplicative group <span class="math notranslate nohighlight">\(G=(\mathbb{Z}/q\mathbb{Z})^\times\)</span> in classes called <cite>Lattice Invariant Classes</cite>.
Two points are in the same class if and only if they generate the same subgroup modulo <span class="math notranslate nohighlight">\(q\)</span>.</p>
<p>When <span class="math notranslate nohighlight">\(q = 15\)</span> these classes are obtained by</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LatticeInvariant</span><span class="p">(</span><span class="mi">15</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="p">(</span><span class="nb">frozenset</span><span class="p">({</span><span class="mi">1</span><span class="p">}),</span> <span class="nb">frozenset</span><span class="p">({</span><span class="mi">4</span><span class="p">}),</span> <span class="nb">frozenset</span><span class="p">({</span><span class="mi">11</span><span class="p">}),</span> <span class="nb">frozenset</span><span class="p">({</span><span class="mi">14</span><span class="p">}),</span> <span class="nb">frozenset</span><span class="p">({</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">}),</span> <span class="nb">frozenset</span><span class="p">({</span><span class="mi">13</span><span class="p">,</span> <span class="mi">7</span><span class="p">}))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">euler_product.utils_euler_product</span> <span class="kn">import</span> <span class="n">LatticeInvariant</span>
<span class="n">LatticeInvariant</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="p">((</span><span class="nb">frozenset</span><span class="p">({</span><span class="mi">1</span><span class="p">}),</span> <span class="nb">frozenset</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">}),</span> <span class="nb">frozenset</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">}),</span> <span class="nb">frozenset</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">}),</span> <span class="nb">frozenset</span><span class="p">({</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">}),</span> <span class="nb">frozenset</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">7</span><span class="p">})),</span>
 <span class="p">(</span><span class="nb">frozenset</span><span class="p">({</span><span class="mi">1</span><span class="p">}),</span> <span class="nb">frozenset</span><span class="p">({</span><span class="mi">4</span><span class="p">}),</span> <span class="nb">frozenset</span><span class="p">({</span><span class="mi">11</span><span class="p">}),</span> <span class="nb">frozenset</span><span class="p">({</span><span class="mi">14</span><span class="p">}),</span> <span class="nb">frozenset</span><span class="p">({</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">}),</span> <span class="nb">frozenset</span><span class="p">({</span><span class="mi">13</span><span class="p">,</span> <span class="mi">7</span><span class="p">})))</span>
</pre></div>
</div>
<p>The output is a couple whose first element is the tuple of the monogenic subgroups of <span class="math notranslate nohighlight">\(G=(\mathbb{Z}/q\mathbb{Z})^\times\)</span> and whose second element is the tuple of lattice invariant classes.</p>
<ul class="simple">
<li><p>Low level tools</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">euler_product.utils_euler_product</span> <span class="kn">import</span> <span class="n">ComponentStructure</span>
<span class="n">mystructure</span> <span class="o">=</span> <span class="n">ComponentStructure</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>This class proposes several quantities. It is used by the high level function <code class="code docutils literal notranslate"><span class="pre">get_vs</span></code> and <code class="code docutils literal notranslate"><span class="pre">get_euler_products</span></code>, so the user does not have to worry about it. However the quantities computed may have interest.</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">mystructure.q</span></code>: the modulus <span class="math notranslate nohighlight">\(q\)</span>.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">mystructure.phi_q</span></code>: the value of the Euler phi-function at <span class="math notranslate nohighlight">\(q\)</span>.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">mystructure.the_exponent</span></code>: the exponent of the group <span class="math notranslate nohighlight">\(G=(\mathbb{Z}/q\mathbb{Z})^\times\)</span>.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">mystructure.invertibles</span></code>: the tuple of invertibles in <span class="math notranslate nohighlight">\((\mathbb{Z}/q\mathbb{Z})\)</span>, i.e. an enumeration of <span class="math notranslate nohighlight">\(G=(\mathbb{Z}/q\mathbb{Z})^\times\)</span>.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">mystructure.the_SG_tuple</span></code>: the tuple of the subgroups of <span class="math notranslate nohighlight">\(G=(\mathbb{Z}/q\mathbb{Z})^\times\)</span> that are generated by a single element. Such subgroups are also called *monogenic* subgroups.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">mystructure.the_Class_tuple</span></code>: the tuple of the lattice invariant classes.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">mystructure.nb_class</span></code>: the number of lattice invariant classes.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">mystructure.character_group</span></code>: the character group of <span class="math notranslate nohighlight">\(G=(\mathbb{Z}/q\mathbb{Z})^\times\)</span>.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">mystructure.invariant_characters</span></code>: for each monogenic subgroup in <code class="code docutils literal notranslate"><span class="pre">mystructure.the_SG_tuple</span></code>, the list of (the indices of) the characters that has this subgroup in its kernel. The order of <code class="code docutils literal notranslate"><span class="pre">mystructure.invariant_characters</span></code> is the same as the one in <code class="code docutils literal notranslate"><span class="pre">mystructure.the_SG_tuple</span></code>.</p></li>
<li><p>Some methods are also available.</p></li>
</ul>
</div></blockquote>
</section>
<section id="euler-product-over-primes-in-arithmetic-progression">
<h2>Euler Product over primes in arithmetic progression<a class="headerlink" href="#euler-product-over-primes-in-arithmetic-progression" title="Link to this heading">#</a></h2>
<p>We start with the three data:</p>
<ul class="simple">
<li><p>A modulus <code class="code docutils literal notranslate"><span class="pre">q</span></code><span class="math notranslate nohighlight">\(\ge 1\)</span>.</p></li>
<li><p>A rational fraction given in the form <span class="math notranslate nohighlight">\(F(x)/H(x)\)</span> where <span class="math notranslate nohighlight">\(F(x)\)</span> and <span class="math notranslate nohighlight">\(H(x)\)</span> are two polynomials with real coefficients and such that <span class="math notranslate nohighlight">\(F(0)=H(0)=1\)</span>.</p></li>
<li><p>A parameter <code class="code docutils literal notranslate"><span class="pre">s</span></code>.</p></li>
<li><p>A wanted precision <code class="code docutils literal notranslate"><span class="pre">nb_decimals</span></code>, given as a number of decimal digits.</p></li>
</ul>
<p>We have access to the lattice invariant classes, as per the preceding paragraph. For each of these classes <span class="math notranslate nohighlight">\((\mathcal{A})\)</span>, we compute</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\prod_{p\in\mathcal{A}}\frac{F(1/p^s)}{H(1/p^s)}.\]</div>
</div>
<p>There is a condition for this product to converge absolutely: on writing <span class="math notranslate nohighlight">\(F(x)-H(x)=x^\Delta T(x)\)</span> for a <span class="math notranslate nohighlight">\(\Delta\ge1\)</span> and a polynomial <span class="math notranslate nohighlight">\(T(x)\)</span>, we need that <span class="math notranslate nohighlight">\(\Delta s &gt;1\)</span>. We assume this condition to hold.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">euler_product.lattice_invariant_euler_products</span> <span class="kn">import</span> <span class="n">get_euler_products</span>
<span class="n">get_euler_products</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">F</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">,</span> <span class="n">H</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">nb_decimals</span><span class="p">,</span> <span class="n">big_p</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">with_Latex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">digits_offset</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>answers a couple whose first component is the tuple of the lattice invariant classes <span class="math notranslate nohighlight">\((\mathcal{A})\)</span>, and second component is the tuple of the values <span class="math notranslate nohighlight">\(\prod_{p\in\mathcal{A}}\frac{F(1/p^s)}{H(1/p^s)}\)</span>, for example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">euler_product.lattice_invariant_euler_products</span> <span class="kn">import</span> <span class="n">get_euler_products</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">get_euler_products</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">frozenset</span><span class="p">({</span><span class="mi">1</span><span class="p">})</span>
<span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="p">(</span><span class="mf">0.9884028950453419692925625250954713121182210521345380891771586345550561301333511982564965807673436742857698303688419181730105231677449</span><span class="p">,</span> <span class="mf">0.9884028950453419692925625250954713121182210521345380891771586345550561301333511982564965807673437490090286957966947966907374203853849</span><span class="p">),</span>
</pre></div>
</div>
<p>which means that</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}0.&amp;9884028950453419692925625250954713121182210521345380891771586345550561301333511982564965807673436742857698303688419181730105231677449\\&amp;\le \prod_{p\equiv 1[5]} \frac{1-1/p^2}{1+1/p^3}\\&amp;\le 0.9884028950453419692925625250954713121182210521345380891771586345550561301333511982564965807673437490090286957966947966907374203853849\end{aligned}\end{align} \]</div>
</div>
<p>With <code class="code docutils literal notranslate"><span class="pre">verbose</span> <span class="pre">=</span> <span class="pre">1</span></code> or <code class="code docutils literal notranslate"><span class="pre">verbose</span> <span class="pre">=</span> <span class="pre">2</span></code>, the results are more explicitly written.</p>
<p>To compute the specific quantities <span class="math notranslate nohighlight">\(\prod_{p\in\mathcal{A}}(1-1/p^s)^{-1}\)</span> where the rational fraction is thus fixed, we have a shortcut:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">euler_product.lattice_invariant_euler_products</span> <span class="kn">import</span> <span class="n">get_vs</span>
<span class="n">get_vs</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">nb_decimals</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">big_p</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_laTeX</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">digits_offset</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>The output is similar to the one of <code class="code docutils literal notranslate"><span class="pre">get_euler_products</span></code>, with the same effect of the available parameters. However, there is the additional possible value <code class="code docutils literal notranslate"><span class="pre">verbose</span> <span class="pre">=</span> <span class="pre">-1</span></code>. In that case the output takes the shape</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">big_p</span><span class="p">,</span> <span class="n">phi_q</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">nb_invariant_class</span><span class="p">,</span> <span class="n">big_m</span><span class="p">,</span> <span class="n">time_end</span> <span class="o">-</span> <span class="n">time_start</span><span class="p">,</span> <span class="n">difference</span><span class="p">]</span>
</pre></div>
</div>
<p>which is rather explicit. The parameter <code class="code docutils literal notranslate"><span class="pre">big_m</span></code> is introduced in the reference paper and <code class="code docutils literal notranslate"><span class="pre">r</span></code> is the number of values of <span class="math notranslate nohighlight">\(m\)</span>, as per Eq. (5) of the reference paper, that are being used. The timing is given in seconds, and <code class="code docutils literal notranslate"><span class="pre">difference</span></code> is an approximation of the number of correct decimals given.</p>
<ul class="simple">
<li><p>Auxiliaries</p></li>
</ul>
<p>We finally provide two auxiliary functions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">euler_product.lattice_invariant_euler_products</span> <span class="kn">import</span> <span class="n">table_performance</span>
<span class="n">table_performance</span><span class="p">(</span><span class="n">min_q</span><span class="p">,</span> <span class="n">max_q</span><span class="p">,</span> <span class="n">nb_decimals</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">big_p</span> <span class="o">=</span> <span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
<p>This gives some timing info for <code class="code docutils literal notranslate"><span class="pre">get_vs(q,</span> <span class="pre">2,</span> <span class="pre">nb_decimals,</span> <span class="pre">big_p,</span> <span class="pre">-1)</span></code>. The output has a LaTeX format of an array, the columns being <code class="code docutils literal notranslate"><span class="pre">q</span></code>, <code class="code docutils literal notranslate"><span class="pre">phi_q</span></code>, <code class="code docutils literal notranslate"><span class="pre">nb_prime_factors_phi_q</span></code>, <code class="code docutils literal notranslate"><span class="pre">r</span></code>, <code class="code docutils literal notranslate"><span class="pre">nb_invariant_class</span></code>, <code class="code docutils literal notranslate"><span class="pre">big_m</span></code> and finally <code class="code docutils literal notranslate"><span class="pre">time_end</span> <span class="pre">-</span> <span class="pre">time_start</span></code> in seconds / 10. The meanings are the same as in <code class="code docutils literal notranslate"><span class="pre">get_vs</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">euler_product.lattice_invariant_euler_products</span> <span class="kn">import</span> <span class="n">get_vs_checker</span>
<span class="n">get_vs_checker</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">borne</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">):</span>
</pre></div>
</div>
<p>This is a simple sanity check. The output <code class="code docutils literal notranslate"><span class="pre">get_vs</span></code> displays the Euler products computed by <code class="code docutils literal notranslate"><span class="pre">get_vs</span></code>, except that these products are only approximated by the truncated Euler product up to <code class="code docutils literal notranslate"><span class="pre">borne</span></code>.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="install_dev.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Installation EULER_PRODUCT</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Home</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023-2024, the sage-euler-product authors
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Tutorial Euler Product</a><ul>
<li><a class="reference internal" href="#introduction-and-principles">Introduction and principles</a></li>
<li><a class="reference internal" href="#euler-product-over-every-primes">Euler Product over every primes</a></li>
<li><a class="reference internal" href="#lattice-invariant-classes-modulo-q">Lattice Invariant Classes modulo <span class="math notranslate nohighlight">\(q\)</span></a></li>
<li><a class="reference internal" href="#euler-product-over-primes-in-arithmetic-progression">Euler Product over primes in arithmetic progression</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=d45e8c67"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>